---
title: 사이트 복구에서 장애 조치(failover) | Microsoft Docs
description: Azure Site Recovery는 가상 머신 및 실제 서버의 복제, 장애 조치 및 복구를 조정합니다. Azure로 또는 보조 데이터 센터로 장애 조치에 대해 알아봅니다.
services: site-recovery
author: rayne-wiselman
manager: carmonm
ms.service: site-recovery
ms.topic: article
ms.date: 05/02/2018
ms.author: ponatara
ms.openlocfilehash: 40f35cde2b55da0763f6ee65b065f5dd8a55b9c6
ms.sourcegitcommit: 870d372785ffa8ca46346f4dfe215f245931dae1
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 05/08/2018
---
# <a name="failover-in-site-recovery"></a>사이트 복구에서 장애 조치
이 문서에서는 Site Recovery에서 보호하는 가상 머신 및 물리적 서버를 장애 조치하는 방법에 대해 설명합니다.

## <a name="prerequisites"></a>필수 조건
1. 장애 조치를 수행하기 전에 [테스트 장애 조치](site-recovery-test-failover-to-azure.md)를 수행하여 모든 것이 예상대로 작동하는지 확인합니다.
1. 장애 조치를 수행하기 전에 대상 위치에서 [네트워크를 준비](site-recovery-network-design.md)합니다.  

다음 표를 사용하여 Azure Site Recovery에서 제공하는 장애 조치 옵션에 대해 알 수 있습니다. 이러한 옵션은 다른 장애 조치 시나리오에도 나열됩니다.

| 시나리오 | 응용 프로그램 복구 요구 사항 | Hyper-V에 대한 워크플로 | VMware에 대한 워크플로
|---|--|--|--|
|예정된 데이터 센터 가동 중지 시간으로 인한 계획된 장애 조치| 계획된 작업을 수행할 때 응용 프로그램에 대한 데이터 손실 없음| Hyper-V의 경우 ASR는 사용자가 지정한 빈도로 데이터를 복제합니다. 계획된 장애 조치는 장애 조치를 시작하기 전에 이 빈도를 재정의하고 최종 변경 내용을 복제하는 데 사용됩니다. <br/> <br/> 1.    비즈니스 변경 관리 프로세스에 따라 유지 관리 기간을 계획합니다. <br/><br/> 2. 예정된 가동 중지 시간을 사용자에게 알립니다. <br/><br/> 3. 사용자용 응용 프로그램을 오프라인으로 전환합니다.<br/><br/>4. ASR 포털을 사용하여 계획된 장애 조치를 시작합니다. 온-프레미스 가상 머신은 자동으로 종료됩니다.<br/><br/>유효한 응용 프로그램 데이터 손실 = 0 <br/><br/>이전의 복구 지점을 사용하려는 사용자에 대해 보존 기간 동안 복구 지점 저널이 제공됩니다. (Hyper-V의 경우 24시간 보존).| VMware의 경우 ASR은 CDP를 사용하여 데이터를 지속적으로 복제합니다. 장애 조치를 통해 최신 데이터로 장애 조치하는 옵션이 사용자에게 제공됩니다(응용 프로그램 종료 후 포함).<br/><br/> 1. 변경 관리 프로세스에 따라 유지 관리 기간을 계획합니다. <br/><br/>2. 예정된 가동 중지 시간을 사용자에게 알립니다. <br/><br/>3.    사용자용 응용 프로그램을 오프라인으로 전환합니다. <br/><br/>4.  응용 프로그램이 오프라인으로 전환된 후에는 ASR 포털을 사용하여 최신 지점으로 계획된 장애 조치(failover)를 시작합니다. 포털에서 [계획되지 않은 장애 조치(failover)] 옵션을 사용하고 장애 조치할 최신 지점을 선택합니다. 온-프레미스 가상 머신은 자동으로 종료됩니다.<br/><br/>유효한 응용 프로그램 데이터 손실 = 0 <br/><br/>이전의 복구 지점을 사용하려는 고객에 대해 보존 기간 동안 복구 지점 저널이 제공됩니다. (VMware의 경우 72시간 보존)
|계획되지 않은 데이터 센터 가동 중지 시간으로 인한 장애 조치(자연 재해 또는 IT 재해) | 응용 프로그램에 대한 최소한의 데이터 손실 | 1. 조직의 BCP 계획을 시작합니다. <br/><br/>2. ASR 포털을 사용하여 최신 또는 보존 기간의 지점(저널)으로 계획되지 않은 장애 조치를 시작합니다.| 1. 조직의 BCP 계획을 시작합니다. <br/><br/>2.  ASR 포털을 사용하여 최신 또는 보존 기간의 지점(저널)으로 계획되지 않은 장애 조치를 시작합니다.


## <a name="run-a-failover"></a>장애 조치(Failover) 실행
이 절차에서는 [복구 계획](site-recovery-create-recovery-plans.md)에 대한 장애 조치를 실행하는 방법을 설명합니다. 또는 **복제된 항목** 페이지에서 단일 가상 머신 또는 물리적 서버에 대한 장애 조치를 실행할 수 있습니다.


![장애 조치(failover)](./media/site-recovery-failover/Failover.png)

1. **복구 계획** > *recoveryplan_name*을 선택합니다. **장애 조치(Failover)** 를 클릭합니다.
2. **장애 조치(Failover)** 화면에서 장애 조치할 **복구 지점**을 선택합니다. 다음 옵션 중 하나를 사용할 수 있습니다.
    1.  **최신**(기본값): 이 옵션은 Site Recovery 서비스에 전송된 모든 데이터를 먼저 처리하여 작업을 시작합니다. 데이터를 처리하면 각 가상 머신에 복구 지점을 만듭니다. 이 복구 지점은 장애 조치 중에 가상 머신에서 사용됩니다. 이 옵션은 장애 조치를 트리거했을 때 Site Recovery 서비스로 복제된 모든 데이터가 장애 조치 후에 만들어진 가상 머신에 있게 되므로 가장 낮은 RPO(복구 지점 목표)를 제공합니다.
    1.  **가장 최근에 처리된 시점**: 복구 계획의 모든 가상 머신을 Site Recovery 서비스에서 이미 처리한 최근 복구 지점으로 장애 조치합니다. 가상 머신의 테스트 장애 조치(Failover)를 수행할 때 가장 최근에 처리된 복구 지점의 타임스탬프도 표시됩니다. 복구 계획의 장애 조치를 수행하는 경우 개별 가상 머신으로 이동하여 **최근 복구 지점** 타일을 살펴보면 이 정보를 얻을 수 있습니다. 처리되지 않은 데이터를 처리하느라 소요되는 시간이 없기 때문에 이 옵션은 낮은 RTO(복구 시간 목표) 장애 조치(Failover) 옵션을 제공합니다.
    1.  **최신 응용 프로그램 일치**: 복구 계획의 모든 가상 머신을 Site Recovery 서비스에서 이미 처리한 최신 응용 프로그램 일치 복구 지점으로 장애 조치합니다. 가상 컴퓨터의 테스트 장애 조치(Failover)를 수행할 때 최신 앱 일치 복구 지점의 타임스탬프도 표시됩니다. 복구 계획의 장애 조치를 수행하는 경우 개별 가상 컴퓨터로 이동하여 **최근 복구 지점** 타일을 살펴보면 이 정보를 얻을 수 있습니다.
    1.  **최신 다중 VM 처리**: 이 옵션은 다중 VM 일관성이 켜져 있는 하나 이상의 가상 머신이 포함된 복구 계획에만 사용할 수 있습니다. 복제 그룹에 속하는 가상 머신은 공통된 최신 다중 VM 일관성 복구 지점으로 장애 조치(failover)됩니다. 다른 가상 머신은 최근에 처리된 복구 지점으로 장애 조치(failover)됩니다.  
    1.  **최신 다중 VM 앱 일치**: 이 옵션은 다중 VM 일관성이 켜져 있는 하나 이상의 가상 머신이 포함된 복구 계획에만 사용할 수 있습니다. 복제 그룹에 속하는 가상 머신은 공통된 최신 다중 VM 응용 프로그램 일관성 복구 지점으로 장애 조치(failover)됩니다. 다른 가상 머신은 최근의 응용 프로그램 일치 복구 지점으로 장애 조치(failover)됩니다.
    1.  **사용자 지정**: 가상 머신의 테스트 장애 조치를 수행하는 경우 이 옵션을 사용하여 특정 복구 지점으로 장애 조치할 수 있습니다.

    > [!NOTE]
    > 복구 지점을 선택하는 옵션은 Azure로 장애 조치하는 경우에만 사용할 수 있습니다.
    >
    >


1. 복구 계획의 가상 머신 중 일부가 이전 실행에서 장애 조치되었고 이제 가상 머신이 원본 위치 및 대상 위치에서 모두 사용되고 있는 경우 장애 조치가 발생되어야 하는 방향은 **방향 변경** 옵션으로 결정할 수 있습니다.
1. Azure로 장애 조치하고 클라우드에 대해 데이터 암호화를 사용하는 경우(VMM 서버에서 Hyper-V 가상 머신을 보호한 경우에만 적용됨) VMM 서버에 설치하는 중에 데이터 암호화를 사용하도록 설정할 때 발행된 인증서를 **암호화 키**에서 선택합니다.
1. 장애 조치를 트리거하기 전에 Site Recovery에서 원본 가상 머신을 종료하려고 시도하는 경우 **장애 조치(failover)를 시작하기 전에 컴퓨터를 종료합니다**를 선택합니다. 종료가 실패하더라도 장애 조치는 계속됩니다.  

    > [!NOTE]
    > Hyper-V 가상 머신이 보호되는 경우에도 종료하는 옵션은 장애 조치를 트리거하기 전에 아직 서비스로 보내지 않은 온-프레미스 데이터를 동기화하려고 시도합니다.
    >
    >

1. **작업** 페이지에서 장애 조치 진행 상황 확인을 수행할 수 있습니다. 계획되지 않은 장애 조치 중에 오류가 발생하더라도 복구 계획은 완료될 때까지 실행됩니다.
1. 장애 조치 후에 가상 머신에 로그인하여 해당 가상 머신의 유효성을 검사합니다. 가상 머신에 대한 다른 복구 지점으로 전환하려면 **복구 지점 변경** 옵션을 사용할 수 있습니다.
1. 장애 조치된 가상 머신에 만족하면 장애 조치를 **커밋**할 수 있습니다. **커밋하면 서비스에서 사용할 수 있는 복구 지점이 모두 삭제**되고 **복구 지점 변경** 옵션을 더 이상 사용할 수 없게 됩니다.

## <a name="planned-failover"></a>계획된 장애 조치
Site Recovery를 사용하여 보호되는 가상 머신/물리적 서버는 **계획된 장애 조치**도 지원합니다. 계획된 장애 조치(failover)는 데이터 무손실 장애 조치 옵션입니다. 계획된 장애 조치(failover)가 트리거되면 먼저 원본 가상 머신이 종료되고, 최신 데이터가 동기화된 다음, 장애 조치(failover)가 트리거됩니다.

> [!NOTE]
> 하나의 온-프레미스 사이트에서 다른 온-프레미스 사이트로 Hyper-V 가상 머신을 장애 조치하는 도중에 기본 온-프레미스 사이트로 다시 돌아가려면 먼저 가상 머신을 기본 사이트로 **역방향 복제**한 다음, 장애 조치를 트리거해야 합니다. 기본 가상 머신을 사용할 수 없는 경우 **역방향 복제**를 시작하기 전에 백업에서 가상 머신을 복원해야 합니다.   
>
>
## <a name="failover-job"></a>장애 조치 작업

![장애 조치(failover)](./media/site-recovery-failover/FailoverJob.png)

장애 조치가 트리거되면 다음 단계를 수행합니다.

1. 필수 조건 확인: 장애 조치에 필요한 모든 조건이 충족되는지 확인합니다.
1. 장애 조치: 데이터를 처리하고 Azure 가상 컴퓨터를 만들 수 있도록 준비합니다. **최신** 복구 지점을 선택한 경우 이 단계는 서비스로 보낸 데이터에서 복구 지점을 만듭니다.
1. 시작: 이전 단계에서 처리한 데이터를 사용하여 Azure 가상 머신을 만듭니다.

> [!WARNING]
> **진행 중인 장애 조치 취소 안 함**: 장애 조치를 시작하기 전에 가상 머신에 대한 복제가 중지됩니다. 진행 중인 작업을 **취소**하면 장애 조치는 중지되지만 가상 머신은 복제를 시작하지 않습니다. 복제를 다시 시작할 수 없습니다.
>
>

## <a name="time-taken-for-failover-to-azure"></a>Azure에 대한 장애 조치(failover)에 걸리는 시간

경우에 따라 가상 머신의 장애 조치(failover)에는 추가적인 중간 단계가 필요하며 일반적으로 완료하는 데 8 ~ 10분 정도가 소요됩니다. 다음과 같은 경우에 장애 조치에 걸리는 시간은 평소보다 길어집니다.

* 9.8 이전 버전의 모바일 서비스를 사용하는 VMware 가상 머신
* 물리적 서버
* VMware Linux 가상 머신
* 물리적 서버로 보호되는 Hyper-V 가상 머신
* 다음 드라이버가 부팅 드라이버로 제공되지 않는 VMware 가상 머신
    * storvsc
    * vmbus
    * storflt
    * intelide
    * atapi
* DHCP 또는 고정 IP 주소 사용 여부와 관계없이 DHCP 서비스를 사용할 수 없는 VMware 가상 머신

다른 모든 경우에는 이러한 중간 단계가 필요하지 않으며 장애 조치(failover)에 소요되는 시간이 짧아집니다.





## <a name="using-scripts-in-failover"></a>장애 조치에서 스크립트 사용
장애 조치를 수행하는 동안 특정 작업을 자동화할 수 있습니다. [복구 계획](site-recovery-create-recovery-plans.md)에서 스크립트 또는 [Azure Automation runbook](site-recovery-runbook-automation.md)을 사용하여 자동화할 수 있습니다.

## <a name="post-failover-considerations"></a>장애 조치 후 고려 사항
장애 조치 후 다음 권장 사항을 고려하는 것이 좋습니다.
### <a name="retaining-drive-letter-after-failover"></a>장애 조치 후 드라이브 문자 유지
장애 조치 후 가상 머신에서 드라이브 문자를 유지하려면 가상 머신에 대한 **SAN 정책**을 **OnlineAll**로 설정하면 됩니다. [자세히 알아보기](https://support.microsoft.com/en-us/help/3031135/how-to-preserve-the-drive-letter-for-protected-virtual-machines-that-are-failed-over-or-migrated-to-azure).



## <a name="next-steps"></a>다음 단계

> [!WARNING]
> 가상 머신을 장애 조치하고 온-프레미스 데이터 센터를 사용할 수 있게 되면 VMware 가상 머신을 온-프레미스 데이터 센터로 [**다시 보호**](vmware-azure-reprotect.md)해야 합니다.

**Failback**에 대한 [**계획된 장애 조치**](hyper-v-azure-failback.md) 옵션을 사용하여 Hyper-v 가상 머신을 Azure의 온-프레미스로 되돌립니다.

Hyper-V 가상 머신을 VMM 서버에서 관리하는 다른 온-프레미스 데이터 센터로 장애 조치하고 기본 데이터 센터를 사용할 수 있는 경우 **역방향 복제** 옵션을 사용하여 기본 데이터 센터로 복제를 다시 시작합니다.
